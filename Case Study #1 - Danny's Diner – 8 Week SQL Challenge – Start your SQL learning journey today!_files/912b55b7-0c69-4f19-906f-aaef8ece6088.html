<!DOCTYPE html>
<!-- saved from url=(0064)https://embed.db-fiddle.com/912b55b7-0c69-4f19-906f-aaef8ece6088 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Danny's Diner SQL Case Study | DB Fiddle - SQL Database Playground</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style type="text/css">
    html,
    body,
    section,
    pre {
      height: 100%;
    }

    main {
      height: calc(100% - 55px);
    }

    body {
      font-family: "Helvetica Neue", Helvetica, Arial;
      font-size: 13px;
      font-weight: 500;
      color: #4d4d4d;
      margin: 0px;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    header {
      font-size: 14px;
      color: #FFF;
      line-height: 55px;
      background-color: #22a5e9;
      padding: 0px 15px;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .btn {
      padding: 6px 10px 7px 10px;
      border-radius: 4px;
      transition: background-color .2s;
    }

    .btn:hover,
    .btn.active {
      background-color: #1488c4;
    }

    #editLink {
      font-size: 13px;
      float: right;
    }

    #editLink:hover {
      text-decoration: underline;
    }

    section{
      border: 1px solid #ddd;
      border-top: 0;
      height: calc(100% - 1px);
    }
    section:not(.active) {
      display: none;
    }

    pre {
      margin: 0px;
    }

    pre code.hljs, #results {
      height: calc(100% - 30px);
    }

    #results{
      padding: 15px;
      font-weight: 400;
    }
    h3{
      font-size: 13px;
      font-weight: 500;
      margin: 0px 0px 10px 0px;
    }
    h3 ~ h3{
      margin-top: 30px;
    }
    .badge{
      display: inline-block;
      font-size: 12px;
      font-weight: 700;
      line-height: 1.5;
      color: #FFF;
      padding: 0px 7px;
      margin-left: 5px;
      border-radius: 5px;
      background-color: #22a5e9;
      border: 1px solid #1488c4;
    }
    table{
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 15px;
    }
    th, td{
      padding: 12px;
      border: 1px solid #ddd;
    }
    th{
      text-align: left;
    }
    tr:nth-child(odd) td {
      background-color: #f5f5f5;
    }

    .hljs {
      display: block;
      overflow-x: auto;
      padding: 15px;
    }

    .hljs,
    .hljs-subst {
      color: #999;
    }

    .hljs-comment {
      color: #777;
    }

    .hljs-keyword,
    .hljs-attribute,
    .hljs-selector-tag,
    .hljs-meta-keyword,
    .hljs-doctag,
    .hljs-name {
      color: #6262FF;
      font-weight: bold
    }

    .hljs-type,
    .hljs-string,
    .hljs-selector-id,
    .hljs-selector-class,
    .hljs-quote,
    .hljs-template-tag,
    .hljs-deletion {
      color: #07a;
    }

    .hljs-number {
      color: #ca7841;
    }

    .hljs-title,
    .hljs-section {
      color: #880000;
      font-weight: bold
    }

    .hljs-regexp,
    .hljs-symbol,
    .hljs-variable,
    .hljs-template-variable,
    .hljs-link,
    .hljs-selector-attr,
    .hljs-selector-pseudo {
      color: #BC6060
    }

    .hljs-literal {
      color: #78A960
    }

    .hljs-built_in,
    .hljs-bullet,
    .hljs-code,
    .hljs-addition {
      color: #9B7536;
    }

    .hljs-meta {
      color: #1f7199
    }

    .hljs-meta-string {
      color: #999;
    }

    .hljs-emphasis {
      font-style: italic
    }

    .hljs-strong {
      font-weight: bold
    }

    @media (max-width: 440px) {
      #editLink{
        position: fixed;
        bottom: 0px;
        left: 0px;
        right: 0px;
        background-color: #22a5e9;
        line-height: normal;
        padding: 10px 0px;
        text-align: center;
      }
      #editLink:hover{
        text-decoration: none;
      }
      pre code.hljs, #results{
        height: calc(100% - 65px);
        overflow: auto;
      }
    }
  </style>
  <script async="" src="./analytics.js.indir"></script><script src="./tracker.js.indir"></script><script type="text/javascript">
    function sendAnalyticsEvent(eventName) {
      // GoSquared
      _gs("event", eventName);
      // Google Analytics
      ga("send", "event", "Fiddle", eventName);
    }

    document.addEventListener("DOMContentLoaded", function () {
      // Bind button click events
      document.querySelectorAll("header .btn").forEach(function (button) {
        button.addEventListener("click", function (e) {
          // Prevent links default behaviour
          e.preventDefault();
          // Return if button is already active
          if (e.target.classList.contains("active")) {
            return false;
          }
          // Remove active state from buttons and sections
          document.querySelectorAll("header .btn.active, section.active").forEach(function (activeButton) {
            activeButton.classList.remove("active");
          });
          // Add active state
          e.target.classList.add("active");
          // Add active state to section
          var href = e.target.getAttribute("href");
          document.querySelector("section" + href).classList.add("active");
          // Send analytics event
          var eventName = "open-" + href.split("#").pop();
          sendAnalyticsEvent(eventName);
        });
      });
    });
  </script>
</head>

<body>
  <header>
    <a href="https://embed.db-fiddle.com/912b55b7-0c69-4f19-906f-aaef8ece6088#schema" class="btn active">Schema SQL</a>
    <a href="https://embed.db-fiddle.com/912b55b7-0c69-4f19-906f-aaef8ece6088#query" class="btn">Query SQL</a>
    <a href="https://embed.db-fiddle.com/912b55b7-0c69-4f19-906f-aaef8ece6088#results" class="btn">Results</a>
    <a href="https://www.db-fiddle.com/f/2rM8RAnq7h5LLDTzZiRWcd/138" target="_blank" id="editLink" onclick="sendAnalyticsEvent(&#39;click-edit-link&#39;)">Edit on DB Fiddle</a>
  </header>
  <main>
    <section class="active" id="schema">
      <pre><code class="hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">SCHEMA</span> dannys_diner;
<span class="hljs-keyword">SET</span> search_path = dannys_diner;

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> sales (
  <span class="hljs-string">"customer_id"</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">1</span>),
  <span class="hljs-string">"order_date"</span> <span class="hljs-built_in">DATE</span>,
  <span class="hljs-string">"product_id"</span> <span class="hljs-built_in">INTEGER</span>
);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> sales
  (<span class="hljs-string">"customer_id"</span>, <span class="hljs-string">"order_date"</span>, <span class="hljs-string">"product_id"</span>)
<span class="hljs-keyword">VALUES</span>
  (<span class="hljs-string">'A'</span>, <span class="hljs-string">'2021-01-01'</span>, <span class="hljs-string">'1'</span>),
  (<span class="hljs-string">'A'</span>, <span class="hljs-string">'2021-01-01'</span>, <span class="hljs-string">'2'</span>),
  (<span class="hljs-string">'A'</span>, <span class="hljs-string">'2021-01-07'</span>, <span class="hljs-string">'2'</span>),
  (<span class="hljs-string">'A'</span>, <span class="hljs-string">'2021-01-10'</span>, <span class="hljs-string">'3'</span>),
  (<span class="hljs-string">'A'</span>, <span class="hljs-string">'2021-01-11'</span>, <span class="hljs-string">'3'</span>),
  (<span class="hljs-string">'A'</span>, <span class="hljs-string">'2021-01-11'</span>, <span class="hljs-string">'3'</span>),
  (<span class="hljs-string">'B'</span>, <span class="hljs-string">'2021-01-01'</span>, <span class="hljs-string">'2'</span>),
  (<span class="hljs-string">'B'</span>, <span class="hljs-string">'2021-01-02'</span>, <span class="hljs-string">'2'</span>),
  (<span class="hljs-string">'B'</span>, <span class="hljs-string">'2021-01-04'</span>, <span class="hljs-string">'1'</span>),
  (<span class="hljs-string">'B'</span>, <span class="hljs-string">'2021-01-11'</span>, <span class="hljs-string">'1'</span>),
  (<span class="hljs-string">'B'</span>, <span class="hljs-string">'2021-01-16'</span>, <span class="hljs-string">'3'</span>),
  (<span class="hljs-string">'B'</span>, <span class="hljs-string">'2021-02-01'</span>, <span class="hljs-string">'3'</span>),
  (<span class="hljs-string">'C'</span>, <span class="hljs-string">'2021-01-01'</span>, <span class="hljs-string">'3'</span>),
  (<span class="hljs-string">'C'</span>, <span class="hljs-string">'2021-01-01'</span>, <span class="hljs-string">'3'</span>),
  (<span class="hljs-string">'C'</span>, <span class="hljs-string">'2021-01-07'</span>, <span class="hljs-string">'3'</span>);
 

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> menu (
  <span class="hljs-string">"product_id"</span> <span class="hljs-built_in">INTEGER</span>,
  <span class="hljs-string">"product_name"</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">5</span>),
  <span class="hljs-string">"price"</span> <span class="hljs-built_in">INTEGER</span>
);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> menu
  (<span class="hljs-string">"product_id"</span>, <span class="hljs-string">"product_name"</span>, <span class="hljs-string">"price"</span>)
<span class="hljs-keyword">VALUES</span>
  (<span class="hljs-string">'1'</span>, <span class="hljs-string">'sushi'</span>, <span class="hljs-string">'10'</span>),
  (<span class="hljs-string">'2'</span>, <span class="hljs-string">'curry'</span>, <span class="hljs-string">'15'</span>),
  (<span class="hljs-string">'3'</span>, <span class="hljs-string">'ramen'</span>, <span class="hljs-string">'12'</span>);
  

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> members (
  <span class="hljs-string">"customer_id"</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">1</span>),
  <span class="hljs-string">"join_date"</span> <span class="hljs-built_in">DATE</span>
);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> members
  (<span class="hljs-string">"customer_id"</span>, <span class="hljs-string">"join_date"</span>)
<span class="hljs-keyword">VALUES</span>
  (<span class="hljs-string">'A'</span>, <span class="hljs-string">'2021-01-07'</span>),
  (<span class="hljs-string">'B'</span>, <span class="hljs-string">'2021-01-09'</span>);</code></pre>
    </section>
    <section id="query">
      <pre><code class="hljs"><span class="hljs-comment">/* --------------------
   Case Study Questions
   --------------------*/</span>

<span class="hljs-comment">-- 1. What is the total amount each customer spent at the restaurant?</span>
<span class="hljs-comment">-- 2. How many days has each customer visited the restaurant?</span>
<span class="hljs-comment">-- 3. What was the first item from the menu purchased by each customer?</span>
<span class="hljs-comment">-- 4. What is the most purchased item on the menu and how many times was it purchased by all customers?</span>
<span class="hljs-comment">-- 5. Which item was the most popular for each customer?</span>
<span class="hljs-comment">-- 6. Which item was purchased first by the customer after they became a member?</span>
<span class="hljs-comment">-- 7. Which item was purchased just before the customer became a member?</span>
<span class="hljs-comment">-- 8. What is the total items and amount spent for each member before they became a member?</span>
<span class="hljs-comment">-- 9.  If each $1 spent equates to 10 points and sushi has a 2x points multiplier - how many points would each customer have?</span>
<span class="hljs-comment">-- 10. In the first week after a customer joins the program (including their join date) they earn 2x points on all items, not just sushi - how many points do customer A and B have at the end of January?</span>

<span class="hljs-comment">-- Example Query:</span>
<span class="hljs-keyword">SELECT</span>
  	product_id,
    product_name,
    price
<span class="hljs-keyword">FROM</span> dannys_diner.menu
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> price <span class="hljs-keyword">DESC</span>
<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">5</span>;</code></pre>
    </section>
    <section id="results">



        <h3>
          Query #1
          <span class="badge">
            Execution time: 0ms
          </span>
        </h3>
                            <table>
                              <thead>
                                <tr>
                                    <th>product_id</th>
                                    <th>product_name</th>
                                    <th>price</th>
                                </tr>
                              </thead>
                              <tbody>
                                  <tr>
                                      <td>2</td>
                                      <td>curry</td>
                                      <td>15</td>
                                  </tr>
                                  <tr>
                                      <td>3</td>
                                      <td>ramen</td>
                                      <td>12</td>
                                  </tr>
                                  <tr>
                                      <td>1</td>
                                      <td>sushi</td>
                                      <td>10</td>
                                  </tr>
                              </tbody>
                            </table>
    </section>
  </main>
  <script>
    !function(g,s,q,r,d){r=g[r]=g[r]||function(){(r.q=r.q||[]).push(
    arguments)};d=s.createElement(q);q=s.getElementsByTagName(q)[0];
    d.src='//d1l6p2sc9645hc.cloudfront.net/tracker.js';q.parentNode.
    insertBefore(d,q)}(window,document,'script','_gs');
    _gs('GSN-683327-B');
  </script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-45377746-7', 'auto');
    ga('send', 'pageview');
  </script>


</body></html>